

Write-Output "This script has been specifically configured for being run in Windows Sandbox. DO NOT RUN IT ON YOUR LOCAL PC!"

$answer = Read-Host "Are you currently on a Sandbox Session? (Yes/No)"


    if ($answer -eq 'Yes') {

        Write-Output "Continuing with sandbox setup script"
        # download the zip file for Notepad++
        Write-Output "Downloading Notepad++"
        Invoke-WebRequest -Uri "https://github.com/notepad-plus-plus/notepad-plus-plus/releases/download/v8.7.8/npp.8.7.8.portable.x64.zip" -OutFile "C:\NP++.zip"


        Write-Output "Extracting Notepad++ to desktop"
        # Expand the archive and place the portable file on the desktop 
        Expand-Archive -Path "C:\NP++.zip" -DestinationPath "C:\Users\WDAGUtilityAccount\Desktop\NP++"

        Write-Output "JDK 21 downloading"
        # Download the JDK21 binary
        Invoke-WebRequest -Uri "https://download.oracle.com/java/21/latest/jdk-21_windows-x64_bin.exe" -OutFile "C:\jdk21.exe"

        Write-Output "JDK 21 installing"
        #Install jdk21 silently
        C:\jdk21.exe /s

        Write-Output "Ghidra downloading"
        #Downloading the Ghidra file
        Invoke-WebRequest -Uri "https://github.com/NationalSecurityAgency/ghidra/releases/download/Ghidra_11.3.1_build/ghidra_11.3.1_PUBLIC_20250219.zip" -OutFile "C:\Ghidra.zip"

        Write-Output "Extracting Ghidra to desktop"
        # Expand the ghidra folder
        Expand-Archive -Path "C:\Ghidra.zip" -DestinationPath "C:\Users\WDAGUtilityAccount\Desktop"

        Write-Output "Downloading Wireshark and it's dependancy NpCap, please run npcap from the installer on desktop"
        Invoke-WebRequest "https://2.na.dl.wireshark.org/win64/Wireshark-4.4.5-x64.exe" -OutFile "C:\wiresharkinstaller.exe"
        Invoke-WebRequest "https://npcap.com/dist/npcap-1.81.exe" -OutFile "C:\Users\WDAGUtilityAccount\Desktop\npcapInstaller.exe"

        C:\wiresharkinstaller.exe /S



    } elseif ($answer -eq 'No') {

        # Display message to advise user this script should only be ran in Sandbox
        Write-Output "Process terminated. Only run this script in Windows Sandbox"


    } else {

        # Displays message letting user know they have to enter yes or no
        Write-Output "Invalid input. Please enter Yes or No."


    }



